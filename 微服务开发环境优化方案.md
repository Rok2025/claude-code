# å¾®æœåŠ¡å¼€å‘ç¯å¢ƒä¼˜åŒ–æ–¹æ¡ˆ

## ç›®å½•
- [é—®é¢˜åˆ†æ](#é—®é¢˜åˆ†æ)
- [å·¥å…·å¯¹æ¯”](#å·¥å…·å¯¹æ¯”)
- [è§£å†³æ–¹æ¡ˆ](#è§£å†³æ–¹æ¡ˆ)
- [Docker éƒ¨ç½²æŒ‡å—](#docker-éƒ¨ç½²æŒ‡å—)
- [æ—¥å¿—æŸ¥çœ‹æ–¹æ¡ˆ](#æ—¥å¿—æŸ¥çœ‹æ–¹æ¡ˆ)
- [æ¨èä½¿ç”¨æµç¨‹](#æ¨èä½¿ç”¨æµç¨‹)

---

## é—®é¢˜åˆ†æ

### å½“å‰é—®é¢˜
- IDEA åŒæ—¶è¿è¡Œ 4 ä¸ª Spring Boot å¾®æœåŠ¡
- å†…å­˜å ç”¨è¿‡é«˜ï¼ˆ8-10GBï¼‰
- Language Server å ç”¨é¢å¤–å†…å­˜ï¼ˆ3GBï¼‰
- ç³»ç»Ÿæ€§èƒ½å—å½±å“

### èµ„æºå ç”¨è¯¦æƒ…
| ç»„ä»¶ | å†…å­˜å ç”¨ |
|------|---------|
| IDEA æœ¬èº« | 1-2GB |
| Java Language Server | 2GB |
| Spring Boot Language Server | 1GB |
| å•ä¸ªå¾®æœåŠ¡ | 512MB-1GB |
| 4ä¸ªå¾®æœåŠ¡æ€»è®¡ | 2-4GB |
| **æ€»è®¡** | **6-9GB** |

---

## å·¥å…·å¯¹æ¯”

### IDEA (IntelliJ IDEA)

**ä¼˜åŠ¿**ï¼š
- âœ… Spring Boot æ”¯æŒæœ€å®Œå–„ï¼ˆåŸç”Ÿæ”¯æŒï¼Œæ— éœ€é¢å¤–é…ç½®ï¼‰
- âœ… å¾®æœåŠ¡æ—¥å¿—æŸ¥çœ‹æ–¹ä¾¿ï¼ˆServices çª—å£å¯ä»¥åŒæ—¶æŸ¥çœ‹å¤šä¸ªæœåŠ¡æ—¥å¿—ï¼‰
- âœ… è°ƒè¯•åŠŸèƒ½å¼ºå¤§ï¼ˆæ–­ç‚¹ã€çƒ­éƒ¨ç½²ã€è¿œç¨‹è°ƒè¯•ï¼‰
- âœ… Maven/Gradle é›†æˆå®Œç¾
- âœ… æ•°æ®åº“å·¥å…·å†…ç½®
- âœ… ä»£ç è¡¥å…¨å’Œé‡æ„åŠŸèƒ½æœ€å¼º

**åŠ£åŠ¿**ï¼š
- âŒ å†…å­˜å ç”¨å¤§ï¼ˆ1-2GBï¼‰
- âŒ å¯åŠ¨æ…¢
- âŒ åŒæ—¶è¿è¡Œå¤šä¸ªå¾®æœåŠ¡æ—¶ç³»ç»Ÿå‹åŠ›å¤§

**é€‚ç”¨åœºæ™¯**ï¼š
- éœ€è¦æ·±åº¦è°ƒè¯•
- å¤æ‚é‡æ„
- é¡¹ç›®åˆæœŸæ­å»º

---

### Antigravity (VS Code)

**ä¼˜åŠ¿**ï¼š
- âœ… è½»é‡çº§ï¼Œå†…å­˜å ç”¨å°‘ï¼ˆ200-500MBï¼‰
- âœ… å¯åŠ¨å¿«é€Ÿ
- âœ… æ’ä»¶ä¸°å¯Œ
- âœ… é€‚åˆæ—¥å¸¸ç¼–ç 

**åŠ£åŠ¿**ï¼š
- âŒ Spring Boot æ—¥å¿—æŸ¥çœ‹ä¸æ–¹ä¾¿ï¼ˆé»˜è®¤ï¼‰
- âŒ å¤šå¾®æœåŠ¡ç®¡ç†ä¸å¦‚ IDEA
- âŒ è°ƒè¯•é…ç½®ç›¸å¯¹å¤æ‚

**é€‚ç”¨åœºæ™¯**ï¼š
- æ—¥å¸¸ç¼–ç 
- æŸ¥çœ‹ä»£ç 
- è½»é‡çº§å¼€å‘

---

## è§£å†³æ–¹æ¡ˆ

### æ–¹æ¡ˆå¯¹æ¯”

| æ–¹æ¡ˆ | å†…å­˜å ç”¨ | å¤æ‚åº¦ | æ¨èåº¦ |
|------|---------|--------|--------|
| IDEA + 4ä¸ªå¾®æœåŠ¡ | 8-10GB | ä½ | â­â­ |
| Antigravity + 4ä¸ªå¾®æœåŠ¡ | 4-5GB | ä½ | â­â­â­ |
| Antigravity + Docker | 3-4GB | ä¸­ | â­â­â­â­â­ |
| IDEA + Docker (3ä¸ª) + 1ä¸ªè°ƒè¯• | 5-6GB | ä¸­ | â­â­â­â­ |

---

## Docker éƒ¨ç½²æŒ‡å—

### 1. ä¸ºæ¯ä¸ªå¾®æœåŠ¡åˆ›å»º Dockerfile

#### æ–¹å¼ A: ä½¿ç”¨å·²æ„å»ºçš„ JARï¼ˆå¿«é€Ÿï¼‰

åœ¨æ¯ä¸ªå¾®æœåŠ¡æ ¹ç›®å½•åˆ›å»º `Dockerfile`ï¼š

```dockerfile
FROM openjdk:21-jdk-slim

# è®¾ç½®å·¥ä½œç›®å½•
WORKDIR /app

# å¤åˆ¶ Maven/Gradle æ„å»ºäº§ç‰©
COPY target/*.jar app.jar

# æš´éœ²ç«¯å£ï¼ˆæ ¹æ®æ‚¨çš„æœåŠ¡ç«¯å£ä¿®æ”¹ï¼‰
EXPOSE 8080

# JVM ä¼˜åŒ–å‚æ•°ï¼Œå‡å°‘å†…å­˜å ç”¨
ENV JAVA_OPTS="-Xmx512m -Xms256m -XX:+UseG1GC -XX:MaxGCPauseMillis=200"

# å¯åŠ¨åº”ç”¨
ENTRYPOINT ["sh", "-c", "java $JAVA_OPTS -jar /app/app.jar"]
```

**ä½¿ç”¨æ­¥éª¤**ï¼š
```bash
# 1. å…ˆç”¨ Maven/Gradle æ„å»º JAR
mvn clean package -DskipTests

# 2. æ„å»º Docker é•œåƒ
docker build -t user-service:latest .

# 3. è¿è¡Œå®¹å™¨
docker run -d -p 8081:8080 --name user-service user-service:latest
```

---

#### æ–¹å¼ B: å¤šé˜¶æ®µæ„å»ºï¼ˆæ¨èï¼Œè‡ªåŠ¨ç¼–è¯‘ï¼‰

##### Maven é¡¹ç›®

```dockerfile
# ç¬¬ä¸€é˜¶æ®µï¼šæ„å»º
FROM maven:3.9-eclipse-temurin-21 AS build
WORKDIR /app

# å¤åˆ¶ pom.xml å’Œæºä»£ç 
COPY pom.xml .
COPY src ./src

# æ„å»ºåº”ç”¨
RUN mvn clean package -DskipTests

# ç¬¬äºŒé˜¶æ®µï¼šè¿è¡Œ
FROM openjdk:21-jdk-slim
WORKDIR /app

# ä»æ„å»ºé˜¶æ®µå¤åˆ¶ JAR
COPY --from=build /app/target/*.jar app.jar

# æš´éœ²ç«¯å£
EXPOSE 8080

# JVM ä¼˜åŒ–å‚æ•°
ENV JAVA_OPTS="-Xmx512m -Xms256m -XX:+UseG1GC -XX:MaxGCPauseMillis=200"

# å¯åŠ¨åº”ç”¨
ENTRYPOINT ["sh", "-c", "java $JAVA_OPTS -jar /app/app.jar"]
```

##### Gradle é¡¹ç›®

```dockerfile
# ç¬¬ä¸€é˜¶æ®µï¼šæ„å»º
FROM gradle:8.5-jdk21 AS build
WORKDIR /app

# å¤åˆ¶æ„å»ºæ–‡ä»¶
COPY build.gradle settings.gradle ./
COPY src ./src

# æ„å»ºåº”ç”¨
RUN gradle clean bootJar --no-daemon

# ç¬¬äºŒé˜¶æ®µï¼šè¿è¡Œ
FROM openjdk:21-jdk-slim
WORKDIR /app

# ä»æ„å»ºé˜¶æ®µå¤åˆ¶ JAR
COPY --from=build /app/build/libs/*.jar app.jar

# æš´éœ²ç«¯å£
EXPOSE 8080

# JVM ä¼˜åŒ–å‚æ•°
ENV JAVA_OPTS="-Xmx512m -Xms256m -XX:+UseG1GC -XX:MaxGCPauseMillis=200"

# å¯åŠ¨åº”ç”¨
ENTRYPOINT ["sh", "-c", "java $JAVA_OPTS -jar /app/app.jar"]
```

**ä½¿ç”¨æ­¥éª¤**ï¼š
```bash
# ä¸€æ¡å‘½ä»¤å®Œæˆæ„å»ºå’Œé•œåƒåˆ›å»º
docker build -t user-service:latest .

# è¿è¡Œå®¹å™¨
docker run -d -p 8081:8080 --name user-service user-service:latest
```

---

### 2. åˆ›å»º Docker Composeï¼ˆç®¡ç†å¤šä¸ªå¾®æœåŠ¡ï¼‰

åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»º `docker-compose.yml`ï¼š

```yaml
version: '3.8'

services:
  # ==================== å¾®æœåŠ¡ ====================

  # ç”¨æˆ·æœåŠ¡
  user-service:
    build:
      context: ./user-service
      dockerfile: Dockerfile
    container_name: user-service
    ports:
      - "8081:8080"
    environment:
      - SPRING_PROFILES_ACTIVE=dev
      - DATABASE_URL=jdbc:mysql://mysql:3306/user_db
      - REDIS_HOST=redis
      - REDIS_PORT=6379
    networks:
      - microservices-network
    depends_on:
      - mysql
      - redis
    restart: unless-stopped
    # èµ„æºé™åˆ¶
    deploy:
      resources:
        limits:
          cpus: '0.5'
          memory: 512M
        reservations:
          memory: 256M

  # è®¢å•æœåŠ¡
  order-service:
    build:
      context: ./order-service
      dockerfile: Dockerfile
    container_name: order-service
    ports:
      - "8082:8080"
    environment:
      - SPRING_PROFILES_ACTIVE=dev
      - DATABASE_URL=jdbc:mysql://mysql:3306/order_db
      - REDIS_HOST=redis
      - USER_SERVICE_URL=http://user-service:8080
    networks:
      - microservices-network
    depends_on:
      - mysql
      - redis
    restart: unless-stopped
    deploy:
      resources:
        limits:
          cpus: '0.5'
          memory: 512M
        reservations:
          memory: 256M

  # å•†å“æœåŠ¡
  product-service:
    build:
      context: ./product-service
      dockerfile: Dockerfile
    container_name: product-service
    ports:
      - "8083:8080"
    environment:
      - SPRING_PROFILES_ACTIVE=dev
      - DATABASE_URL=jdbc:mysql://mysql:3306/product_db
      - REDIS_HOST=redis
    networks:
      - microservices-network
    depends_on:
      - mysql
      - redis
    restart: unless-stopped
    deploy:
      resources:
        limits:
          cpus: '0.5'
          memory: 512M
        reservations:
          memory: 256M

  # æ”¯ä»˜æœåŠ¡
  payment-service:
    build:
      context: ./payment-service
      dockerfile: Dockerfile
    container_name: payment-service
    ports:
      - "8084:8080"
    environment:
      - SPRING_PROFILES_ACTIVE=dev
      - DATABASE_URL=jdbc:mysql://mysql:3306/payment_db
      - ORDER_SERVICE_URL=http://order-service:8080
    networks:
      - microservices-network
    depends_on:
      - mysql
    restart: unless-stopped
    deploy:
      resources:
        limits:
          cpus: '0.5'
          memory: 512M
        reservations:
          memory: 256M

  # ==================== åŸºç¡€è®¾æ–½ ====================

  # MySQL æ•°æ®åº“
  mysql:
    image: mysql:8.0
    container_name: mysql
    ports:
      - "3306:3306"
    environment:
      - MYSQL_ROOT_PASSWORD=root123
      - MYSQL_DATABASE=mydb
    volumes:
      - mysql-data:/var/lib/mysql
      # å¦‚æœæœ‰åˆå§‹åŒ–è„šæœ¬ï¼Œå¯ä»¥æŒ‚è½½
      # - ./init-scripts:/docker-entrypoint-initdb.d
    networks:
      - microservices-network
    restart: unless-stopped

  # Redis ç¼“å­˜
  redis:
    image: redis:7-alpine
    container_name: redis
    ports:
      - "6379:6379"
    networks:
      - microservices-network
    restart: unless-stopped

  # Nacos æ³¨å†Œä¸­å¿ƒï¼ˆå¦‚æœä½¿ç”¨ï¼‰
  # nacos:
  #   image: nacos/nacos-server:v2.2.3
  #   container_name: nacos
  #   ports:
  #     - "8848:8848"
  #     - "9848:9848"
  #   environment:
  #     - MODE=standalone
  #   networks:
  #     - microservices-network
  #   restart: unless-stopped

networks:
  microservices-network:
    driver: bridge

volumes:
  mysql-data:
```

---

### 3. Docker Compose å¸¸ç”¨å‘½ä»¤

```bash
# ==================== æ„å»ºå’Œå¯åŠ¨ ====================

# æ„å»ºæ‰€æœ‰æœåŠ¡é•œåƒ
docker-compose build

# æ„å»ºæŒ‡å®šæœåŠ¡
docker-compose build user-service

# å¯åŠ¨æ‰€æœ‰æœåŠ¡ï¼ˆåå°è¿è¡Œï¼‰
docker-compose up -d

# å¯åŠ¨æ‰€æœ‰æœåŠ¡ï¼ˆå‰å°è¿è¡Œï¼Œå¯ä»¥ç›´æ¥çœ‹æ—¥å¿—ï¼‰
docker-compose up

# å¯åŠ¨æŒ‡å®šæœåŠ¡
docker-compose up -d user-service order-service

# é‡æ–°æ„å»ºå¹¶å¯åŠ¨
docker-compose up -d --build


# ==================== åœæ­¢å’Œåˆ é™¤ ====================

# åœæ­¢æ‰€æœ‰æœåŠ¡
docker-compose stop

# åœæ­¢æŒ‡å®šæœåŠ¡
docker-compose stop user-service

# åœæ­¢å¹¶åˆ é™¤å®¹å™¨ï¼ˆä¸åˆ é™¤æ•°æ®å·ï¼‰
docker-compose down

# åœæ­¢å¹¶åˆ é™¤å®¹å™¨å’Œæ•°æ®å·
docker-compose down -v


# ==================== æŸ¥çœ‹çŠ¶æ€ ====================

# æŸ¥çœ‹æ‰€æœ‰æœåŠ¡çŠ¶æ€
docker-compose ps

# æŸ¥çœ‹æœåŠ¡æ—¥å¿—
docker-compose logs

# å®æ—¶æŸ¥çœ‹æ—¥å¿—ï¼ˆ-f è¡¨ç¤º followï¼‰
docker-compose logs -f

# æŸ¥çœ‹æŒ‡å®šæœåŠ¡æ—¥å¿—
docker-compose logs -f user-service

# æŸ¥çœ‹æœ€è¿‘ 100 è¡Œæ—¥å¿—
docker-compose logs --tail=100 user-service


# ==================== é‡å¯æœåŠ¡ ====================

# é‡å¯æ‰€æœ‰æœåŠ¡
docker-compose restart

# é‡å¯æŒ‡å®šæœåŠ¡
docker-compose restart user-service


# ==================== è¿›å…¥å®¹å™¨ ====================

# è¿›å…¥å®¹å™¨å†…éƒ¨
docker-compose exec user-service bash

# æˆ–ä½¿ç”¨ shï¼ˆå¦‚æœå®¹å™¨æ˜¯ alpine åŸºç¡€é•œåƒï¼‰
docker-compose exec user-service sh


# ==================== æ¸…ç† ====================

# åˆ é™¤æ‰€æœ‰åœæ­¢çš„å®¹å™¨
docker container prune

# åˆ é™¤æœªä½¿ç”¨çš„é•œåƒ
docker image prune

# åˆ é™¤æœªä½¿ç”¨çš„æ•°æ®å·
docker volume prune

# æ¸…ç†æ‰€æœ‰æœªä½¿ç”¨çš„èµ„æº
docker system prune -a
```

---

## æ—¥å¿—æŸ¥çœ‹æ–¹æ¡ˆ

### æ–¹æ¡ˆ 1: ä½¿ç”¨ç»ˆç«¯å‘½ä»¤ï¼ˆæœ€ç®€å•ï¼‰

```bash
# æŸ¥çœ‹æ‰€æœ‰æœåŠ¡æ—¥å¿—
docker-compose logs -f

# æŸ¥çœ‹å•ä¸ªæœåŠ¡æ—¥å¿—
docker-compose logs -f user-service

# æŸ¥çœ‹å¤šä¸ªæœåŠ¡æ—¥å¿—
docker-compose logs -f user-service order-service

# æŸ¥çœ‹æœ€è¿‘ 100 è¡Œ
docker-compose logs --tail=100 user-service

# æŸ¥çœ‹å¸¦æ—¶é—´æˆ³çš„æ—¥å¿—
docker-compose logs -f --timestamps user-service
```

---

### æ–¹æ¡ˆ 2: Antigravity/VS Code æ‰©å±•ï¼ˆæ¨èï¼‰

#### å®‰è£…æ‰©å±•

1. **Spring Boot Dashboard**
   - æ‰©å±• ID: `vscjava.vscode-spring-boot-dashboard`
   - åŠŸèƒ½ï¼šå¯è§†åŒ–ç®¡ç† Spring Boot åº”ç”¨ï¼ŒæŸ¥çœ‹æ—¥å¿—

2. **Docker**
   - æ‰©å±• ID: `ms-azuretools.vscode-docker`
   - åŠŸèƒ½ï¼šç®¡ç† Docker å®¹å™¨ï¼Œå³é”®æŸ¥çœ‹æ—¥å¿—

#### å®‰è£…å‘½ä»¤

```bash
# å¦‚æœ Antigravity æ”¯æŒå‘½ä»¤è¡Œå®‰è£…
code --install-extension vscjava.vscode-spring-boot-dashboard
code --install-extension ms-azuretools.vscode-docker
```

#### ä½¿ç”¨æ–¹æ³•

**Spring Boot Dashboard**:
1. æ‰“å¼€ä¾§è¾¹æ  Spring Boot Dashboard é¢æ¿
2. å¯ä»¥çœ‹åˆ°æ‰€æœ‰ Spring Boot åº”ç”¨
3. ç‚¹å‡»åº”ç”¨æ—è¾¹çš„ â–¶ï¸ å¯åŠ¨
4. ç‚¹å‡» ğŸ“„ æŸ¥çœ‹æ—¥å¿—

**Docker æ‰©å±•**:
1. æ‰“å¼€ä¾§è¾¹æ  Docker é¢æ¿
2. å±•å¼€ Containers
3. å³é”®å®¹å™¨ â†’ View Logs
4. å¯ä»¥åŒæ—¶æ‰“å¼€å¤šä¸ªæ—¥å¿—çª—å£

---

### æ–¹æ¡ˆ 3: ä½¿ç”¨ Tmux åˆ†å±æŸ¥çœ‹ï¼ˆè¿›é˜¶ï¼‰

åˆ›å»ºè„šæœ¬ `view-logs.sh`ï¼š

```bash
#!/bin/bash

# åˆ›å»º tmux ä¼šè¯ï¼Œ4 åˆ†å±æŸ¥çœ‹ 4 ä¸ªæœåŠ¡æ—¥å¿—
tmux new-session -d -s microservices

# åˆ†å‰²çª—å£
tmux split-window -h
tmux split-window -v
tmux select-pane -t 0
tmux split-window -v

# åœ¨æ¯ä¸ªçª—æ ¼ä¸­è¿è¡Œæ—¥å¿—å‘½ä»¤
tmux send-keys -t 0 'docker-compose logs -f user-service' C-m
tmux send-keys -t 1 'docker-compose logs -f order-service' C-m
tmux send-keys -t 2 'docker-compose logs -f product-service' C-m
tmux send-keys -t 3 'docker-compose logs -f payment-service' C-m

# é™„åŠ åˆ°ä¼šè¯
tmux attach-session -t microservices
```

ä½¿ç”¨ï¼š
```bash
chmod +x view-logs.sh
./view-logs.sh
```

é€€å‡ºï¼šæŒ‰ `Ctrl+B` ç„¶åæŒ‰ `D`

---

### æ–¹æ¡ˆ 4: ä½¿ç”¨æ—¥å¿—èšåˆå·¥å…·ï¼ˆç”Ÿäº§çº§ï¼‰

#### å®‰è£… Loki + Grafanaï¼ˆå¯é€‰ï¼‰

åœ¨ `docker-compose.yml` ä¸­æ·»åŠ ï¼š

```yaml
  # Loki - æ—¥å¿—æ”¶é›†
  loki:
    image: grafana/loki:2.9.0
    ports:
      - "3100:3100"
    command: -config.file=/etc/loki/local-config.yaml
    networks:
      - microservices-network

  # Promtail - æ—¥å¿—é‡‡é›†
  promtail:
    image: grafana/promtail:2.9.0
    volumes:
      - /var/lib/docker/containers:/var/lib/docker/containers:ro
      - ./promtail-config.yaml:/etc/promtail/config.yaml
    command: -config.file=/etc/promtail/config.yaml
    networks:
      - microservices-network

  # Grafana - æ—¥å¿—å¯è§†åŒ–
  grafana:
    image: grafana/grafana:10.0.0
    ports:
      - "3000:3000"
    environment:
      - GF_SECURITY_ADMIN_PASSWORD=admin
    networks:
      - microservices-network
```

è®¿é—® `http://localhost:3000` æŸ¥çœ‹å¯è§†åŒ–æ—¥å¿—

---

## æ¨èä½¿ç”¨æµç¨‹

### æµç¨‹å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              å¼€å‘åœºæ™¯å†³ç­–æ ‘                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                      â”‚
â”‚  éœ€è¦æ·±åº¦è°ƒè¯•æŸä¸ªæœåŠ¡ï¼Ÿ                              â”‚
â”‚         â”‚                                            â”‚
â”‚         â”œâ”€â”€â”€ æ˜¯ â”€â”€â†’ IDEAï¼ˆå¯åŠ¨å•ä¸ªæœåŠ¡è°ƒè¯•ï¼‰        â”‚
â”‚         â”‚                                            â”‚
â”‚         â””â”€â”€â”€ å¦ â”€â”€â†’ ç»§ç»­åˆ¤æ–­                         â”‚
â”‚                 â”‚                                    â”‚
â”‚                 åªéœ€è¦è¿è¡ŒæœåŠ¡ï¼Ÿ                     â”‚
â”‚                 â”‚                                    â”‚
â”‚                 â”œâ”€â”€â”€ æ˜¯ â”€â”€â†’ Docker Compose          â”‚
â”‚                 â”‚                                    â”‚
â”‚                 â””â”€â”€â”€ å¦ â”€â”€â†’ æŸ¥çœ‹/ç¼–è¾‘ä»£ç             â”‚
â”‚                             â”‚                        â”‚
â”‚                             â””â”€â”€â†’ Antigravity        â”‚
â”‚                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### æ¨èæ–¹æ¡ˆ 1: æ··åˆä½¿ç”¨ï¼ˆæœ€ä½³å¹³è¡¡ï¼‰

#### æ—¥å¸¸å¼€å‘ï¼ˆè½»é‡æ¨¡å¼ï¼‰

```bash
# 1. ç”¨ Docker å¯åŠ¨æ‰€æœ‰å¾®æœåŠ¡
cd your-project
docker-compose up -d

# 2. ç”¨ Antigravity ç¼–è¾‘ä»£ç 
code .

# 3. æŸ¥çœ‹æ—¥å¿—ï¼ˆé€‰æ‹©ä»»ä¸€æ–¹å¼ï¼‰
# æ–¹å¼ A: ä½¿ç”¨ Docker æ‰©å±•ï¼ˆåœ¨ Antigravity ä¾§è¾¹æ ï¼‰
# æ–¹å¼ B: ä½¿ç”¨ç»ˆç«¯
docker-compose logs -f user-service

# 4. ä¿®æ”¹ä»£ç åé‡æ–°æ„å»ºå¹¶é‡å¯
docker-compose up -d --build user-service
```

**ä¼˜ç‚¹**ï¼š
- âœ… å†…å­˜å ç”¨ä½ï¼ˆ3-4GBï¼‰
- âœ… å“åº”é€Ÿåº¦å¿«
- âœ… é€‚åˆæ—¥å¸¸ç¼–ç 

---

#### è°ƒè¯•æ¨¡å¼ï¼ˆé‡åº¦æ¨¡å¼ï¼‰

```bash
# 1. åœæ­¢éœ€è¦è°ƒè¯•çš„æœåŠ¡ï¼ˆæ¯”å¦‚ user-serviceï¼‰
docker-compose stop user-service

# 2. å…¶ä»–æœåŠ¡ç»§ç»­åœ¨ Docker ä¸­è¿è¡Œ
docker-compose ps  # ç¡®è®¤çŠ¶æ€

# 3. ç”¨ IDEA æ‰“å¼€é¡¹ç›®
# 4. åœ¨ IDEA ä¸­å¯åŠ¨ user-serviceï¼Œè®¾ç½®æ–­ç‚¹è°ƒè¯•
# 5. user-service å¯ä»¥é€šè¿‡ localhost:8082, localhost:8083 è®¿é—®å…¶ä»–æœåŠ¡

# 6. è°ƒè¯•å®Œæˆåï¼Œåœæ­¢ IDEA ä¸­çš„æœåŠ¡ï¼Œé‡æ–°å¯åŠ¨ Docker å®¹å™¨
docker-compose start user-service
```

**ä¼˜ç‚¹**ï¼š
- âœ… è°ƒè¯•åŠŸèƒ½å®Œæ•´
- âœ… å…¶ä»–æœåŠ¡ä¸å ç”¨ IDEA èµ„æº
- âœ… å†…å­˜å ç”¨é€‚ä¸­ï¼ˆ5-6GBï¼‰

---

### æ¨èæ–¹æ¡ˆ 2: çº¯ Dockerï¼ˆæè‡´è½»é‡ï¼‰

```bash
# 1. æ‰€æœ‰æœåŠ¡éƒ½ç”¨ Docker è¿è¡Œ
docker-compose up -d

# 2. ç”¨ Antigravity ç¼–è¾‘ä»£ç 

# 3. ä½¿ç”¨ Docker æ‰©å±•æŸ¥çœ‹æ—¥å¿—

# 4. ä»£ç ä¿®æ”¹åï¼Œé‡æ–°æ„å»º
docker-compose up -d --build

# 5. å¦‚æœéœ€è¦ç®€å•è°ƒè¯•ï¼Œä½¿ç”¨è¿œç¨‹è°ƒè¯•
# åœ¨ Dockerfile ä¸­æ·»åŠ ï¼š
# ENV JAVA_OPTS="-agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=*:5005"
# ç„¶ååœ¨ Antigravity ä¸­é…ç½®è¿œç¨‹è°ƒè¯•
```

**ä¼˜ç‚¹**ï¼š
- âœ… å†…å­˜å ç”¨æœ€ä½ï¼ˆ3-4GBï¼‰
- âœ… æœ€æ¥è¿‘ç”Ÿäº§ç¯å¢ƒ
- âœ… æœåŠ¡éš”ç¦»å¥½

**ç¼ºç‚¹**ï¼š
- âŒ è°ƒè¯•ç›¸å¯¹ä¸ä¾¿
- âŒ ä»£ç ä¿®æ”¹éœ€è¦é‡æ–°æ„å»º

---

### æ¨èæ–¹æ¡ˆ 3: çº¯ IDEAï¼ˆç®€å•ç›´æ¥ï¼‰

é€‚åˆï¼š
- é¡¹ç›®åˆæœŸ
- å›¢é˜Ÿæˆå‘˜ä¸ç†Ÿæ‚‰ Docker
- ç”µè„‘å†…å­˜å……è¶³ï¼ˆ16GB+ï¼‰

```bash
# ç›´æ¥åœ¨ IDEA ä¸­å¯åŠ¨æ‰€æœ‰æœåŠ¡
# ä½¿ç”¨ Services çª—å£ç®¡ç†
```

**ä¼˜ç‚¹**ï¼š
- âœ… é…ç½®ç®€å•
- âœ… è°ƒè¯•æ–¹ä¾¿
- âœ… å­¦ä¹ æˆæœ¬ä½

**ç¼ºç‚¹**ï¼š
- âŒ å†…å­˜å ç”¨é«˜
- âŒ ç³»ç»Ÿå‹åŠ›å¤§

---

## å†…å­˜å ç”¨å¯¹æ¯”æ€»ç»“

| æ¨¡å¼ | å†…å­˜å ç”¨ | é€‚ç”¨åœºæ™¯ | æ¨èåº¦ |
|------|---------|---------|--------|
| IDEA + 4ä¸ªå¾®æœåŠ¡ | 8-10GB | é¡¹ç›®åˆæœŸï¼Œæ·±åº¦è°ƒè¯• | â­â­ |
| Antigravity + 4ä¸ªå¾®æœåŠ¡ | 4-5GB | æ—¥å¸¸ç¼–ç  | â­â­â­ |
| **Antigravity + Docker (4ä¸ª)** | **3-4GB** | **æ—¥å¸¸å¼€å‘ï¼ˆæ¨èï¼‰** | **â­â­â­â­â­** |
| **IDEA + Docker (3ä¸ª) + 1ä¸ªè°ƒè¯•** | **5-6GB** | **è°ƒè¯•åœºæ™¯ï¼ˆæ¨èï¼‰** | **â­â­â­â­** |
| Docker + è¿œç¨‹è°ƒè¯• | 3-4GB | æè‡´è½»é‡ | â­â­â­â­ |

---

## å¿«é€Ÿå¼€å§‹

### æ­¥éª¤ 1: ä¸ºæ¯ä¸ªå¾®æœåŠ¡åˆ›å»º Dockerfile

```bash
# åœ¨æ¯ä¸ªå¾®æœåŠ¡ç›®å½•ä¸‹åˆ›å»º Dockerfile
cd user-service
# å¤åˆ¶ä¸Šé¢çš„ Dockerfile æ¨¡æ¿
```

### æ­¥éª¤ 2: åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»º docker-compose.yml

```bash
# åœ¨é¡¹ç›®æ ¹ç›®å½•
# å¤åˆ¶ä¸Šé¢çš„ docker-compose.yml æ¨¡æ¿
# æ ¹æ®å®é™…æƒ…å†µä¿®æ”¹æœåŠ¡åã€ç«¯å£ã€ç¯å¢ƒå˜é‡
```

### æ­¥éª¤ 3: æ„å»ºå¹¶å¯åŠ¨

```bash
# æ„å»ºé•œåƒ
docker-compose build

# å¯åŠ¨æ‰€æœ‰æœåŠ¡
docker-compose up -d

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f
```

### æ­¥éª¤ 4: åœ¨ Antigravity ä¸­å®‰è£…æ‰©å±•

```bash
# å®‰è£… Docker æ‰©å±•
code --install-extension ms-azuretools.vscode-docker

# å®‰è£… Spring Boot Dashboard æ‰©å±•
code --install-extension vscjava.vscode-spring-boot-dashboard
```

### æ­¥éª¤ 5: å¼€å§‹å¼€å‘

```bash
# ç”¨ Antigravity æ‰“å¼€é¡¹ç›®
code .

# åœ¨ä¾§è¾¹æ  Docker é¢æ¿ä¸­å³é”®å®¹å™¨æŸ¥çœ‹æ—¥å¿—
```

---

## å¸¸è§é—®é¢˜

### Q1: Docker å®¹å™¨å¯åŠ¨åï¼ŒæœåŠ¡ä¹‹é—´æ— æ³•è®¿é—®ï¼Ÿ

**A**: ç¡®ä¿æ‰€æœ‰æœåŠ¡åœ¨åŒä¸€ä¸ª network ä¸­ï¼Œå¹¶ä½¿ç”¨æœåŠ¡åè®¿é—®ã€‚

```yaml
# åœ¨ docker-compose.yml ä¸­
services:
  user-service:
    networks:
      - microservices-network
  order-service:
    networks:
      - microservices-network

networks:
  microservices-network:
    driver: bridge
```

åœ¨ä»£ç ä¸­è®¿é—®ï¼š
```properties
# order-service è®¿é—® user-service
user.service.url=http://user-service:8080
```

---

### Q2: ä¿®æ”¹ä»£ç åå¦‚ä½•å¿«é€Ÿç”Ÿæ•ˆï¼Ÿ

**æ–¹å¼ 1: é‡æ–°æ„å»ºå•ä¸ªæœåŠ¡**
```bash
docker-compose up -d --build user-service
```

**æ–¹å¼ 2: ä½¿ç”¨çƒ­éƒ¨ç½²ï¼ˆSpring Boot DevToolsï¼‰**
```xml
<!-- pom.xml -->
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-devtools</artifactId>
    <optional>true</optional>
</dependency>
```

---

### Q3: å¦‚ä½•æŸ¥çœ‹å®¹å™¨å†…çš„æ–‡ä»¶ï¼Ÿ

```bash
# è¿›å…¥å®¹å™¨
docker-compose exec user-service sh

# æˆ–ä½¿ç”¨ bash
docker-compose exec user-service bash

# æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶
cat /app/logs/app.log
```

---

### Q4: å¦‚ä½•æ¸…ç† Docker å ç”¨çš„ç©ºé—´ï¼Ÿ

```bash
# åˆ é™¤æ‰€æœ‰åœæ­¢çš„å®¹å™¨
docker container prune

# åˆ é™¤æœªä½¿ç”¨çš„é•œåƒ
docker image prune -a

# åˆ é™¤æœªä½¿ç”¨çš„æ•°æ®å·
docker volume prune

# ä¸€é”®æ¸…ç†æ‰€æœ‰
docker system prune -a --volumes
```

---

### Q5: æ•°æ®åº“æ•°æ®ä¸¢å¤±æ€ä¹ˆåŠï¼Ÿ

ä½¿ç”¨ volumes æŒä¹…åŒ–æ•°æ®ï¼š

```yaml
services:
  mysql:
    volumes:
      - mysql-data:/var/lib/mysql

volumes:
  mysql-data:
```

è¿™æ ·å³ä½¿åˆ é™¤å®¹å™¨ï¼Œæ•°æ®ä»ç„¶ä¿ç•™åœ¨ volume ä¸­ã€‚

---

## é™„å½•ï¼šå®Œæ•´é¡¹ç›®ç»“æ„ç¤ºä¾‹

```
your-microservices-project/
â”œâ”€â”€ docker-compose.yml          # Docker Compose é…ç½®
â”œâ”€â”€ init-scripts/               # æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬ï¼ˆå¯é€‰ï¼‰
â”‚   â”œâ”€â”€ 01-create-databases.sql
â”‚   â””â”€â”€ 02-init-data.sql
â”œâ”€â”€ user-service/
â”‚   â”œâ”€â”€ Dockerfile
â”‚   â”œâ”€â”€ pom.xml
â”‚   â””â”€â”€ src/
â”œâ”€â”€ order-service/
â”‚   â”œâ”€â”€ Dockerfile
â”‚   â”œâ”€â”€ pom.xml
â”‚   â””â”€â”€ src/
â”œâ”€â”€ product-service/
â”‚   â”œâ”€â”€ Dockerfile
â”‚   â”œâ”€â”€ pom.xml
â”‚   â””â”€â”€ src/
â”œâ”€â”€ payment-service/
â”‚   â”œâ”€â”€ Dockerfile
â”‚   â”œâ”€â”€ pom.xml
â”‚   â””â”€â”€ src/
â””â”€â”€ view-logs.sh               # æ—¥å¿—æŸ¥çœ‹è„šæœ¬ï¼ˆå¯é€‰ï¼‰
```

---

## å‚è€ƒèµ„æº

- [Docker å®˜æ–¹æ–‡æ¡£](https://docs.docker.com/)
- [Docker Compose æ–‡æ¡£](https://docs.docker.com/compose/)
- [Spring Boot Docker æŒ‡å—](https://spring.io/guides/gs/spring-boot-docker/)
- [VS Code Docker æ‰©å±•](https://marketplace.visualstudio.com/items?itemName=ms-azuretools.vscode-docker)

---

**æœ€åæ›´æ–°**: 2026-01-07
**é€‚ç”¨ç¯å¢ƒ**: macOS / Linux / Windows (WSL2)
